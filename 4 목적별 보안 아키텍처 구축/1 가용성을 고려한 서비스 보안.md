# 가용성을 고려한 서비스 보안
- 가용성이 고려된 아키텍처는 보안 기술 요소가 반영되어 적용되어야 한다.
- 가용성을 위한 요구사항
  - 서비스는 언제나 제공되어야 함
  - 장애가 발생하더라도 서비스는 유지되어야 함
  - 전반적인 지역의 자연재해, 물리적 파손 등에도 데이터는 보존되고 서비스는 제공되어야 함

## 1. 멀티 리전 기반의 아키텍처와 보안 고려사항
- 클라우드에서 **리전**은 특정 지역을 의미한다.
- **멀티 리전**은 다중 지역, 즉 여러 지역에 시스템을 복제하거나 준비하여 특정 지역에서 장애나 해킹 등으로 가용성에 문제가 발생했을 때 가용성을 확보하기 위해 사용한다.
  - 멀티 리전으로 구축한 시스템은 특정한 리전의 전체적인 장애 영향을 최소화하고, 다른 리전에서 사용자 요청을 처리함으로써 지속적인 서비스를 제공한다.
- 특히, 멀티 리전 구조의 아키텍처를 구축하여, 물리적인 문제를 경감시킬 수 있다.
  - 로드밸런서를 통해 자원의 오토 스케일링을 설정하고 스케일 아웃을 수행하여 자원을 수평적으로 확장하며 유동적으로 활용한다.
  - 데이터베이스의 경우에느 읽기와 쓰기 요청을 별초로 처리하는 쿼리 오프로딩 기술을 활용하여가용성을 확보할 수 있다.
- 특정한 자원에 장애가 발생하면 **GSLB**(Global Server Load Balancing)을 통해 로드밸런서의 헬스체크 기능으로 가동 중인 자원으로 접속 가능하게 한다.
  - GSLB는 리전과 리전 간의 연결을 수행하여 특정 리전에 자연재해나 시스템 장애가 발생하더라고 서비스가 가능한 다른 지역에서 서비스가 제공될 수 있도록 분산하는 역할을 한다.
- 멀티 리전의 보안 고려사항
  - 여러 리전이 하나의 네트워크처럼 연결되어 있는가?
  - 여러 리전의 시스템 설정이나 계정이 같게 설정되어 하나의 계정으로 여러 리전의 시스템에 모두 접속할 수 있는가?
  - 여러 리전 간의 데이터 통신 시 안전하게 데이터가 복제, 전송되는가?
- 멀티 리전의 보안 위험을 해결하기 위해 고려할 보안 요소는 멀티 리전에 있는 **리소스 간의 접근통제와 설정에 대한 독립적인 관리**이다.
  - 즉,하나의 리전에 랜섬웨어나 악성코드 등의 공격으로 가용성에 문제가 발생할 경우, 같은 환경과 애플리케이션 코드로 서비스를 수행하는 다른 리전에도 문제가 발생할 수 있다.
    - 이를 해결하기 위해서는 로드밸런서와 자원 등의 방화벽 구성에는 통신에 필요한 최소한의 IP와 포트만 허용해야 한다.
    - 즉, 클라우드 서비스의 제공 유형에 따라 보안 서비스와 솔루션의 구성 검토가 필요하다.
    - 가용성 확보를 위한 멀티 리전 기반은 기존 기업 시스템 환경의 재해 복구 시스템을 구성하는 것과 유사하다.

## 2. 멀티 클라우드 기반의 아키텍처와 보안 고려사항
- 단일 클라우드 서비스 제공자를 이용한 서비스 사용 시 발생할 수 있는 가용성 문제는 특정 클라우드 서비스에 대한 의존도가 높아질 수록 시스템 종속성이 발생하는 것이다.
- 여러 클라우드 서비스 제공자를 활용하는 **멀티 클라우드** 기반을 이용하면 하나의 클라우드에 종속되는 위험을 줄일 수 있다.
- 가용성 확보를 위해, 다양한 클라우드 제공 업체의 서비스를 혼합하는 방식을 검토한다.
  - 각 클라우드 업체의 장점만 선택해 활용하는 방식으로 가용성과 성능을 확보할 수 있다.
    - 예) 사용자 인증 시스템은 Azure의 Active Directory, 시스템에서 발생하는 데이터나 로그 정보는 AWS의 S3 스토리지
  - 개별 클라우드를 퍼블릭 서브넷과 프라이빗 서브넷으로 분리하고, 인/아웃 바운드 방화벽과 엣지 포인트 설정을 대역이 아닌 구체적으로 설정하여 기본적인 보안 환경을 구성한다.
  - 또한, 인터넷 공용망으로 통신하는 구간은 통신 구간 암호화로 네트워크 보안 수준을 향상한다.
- 멀티 클라우드를 이용할 경우, 클라우드별 장단점을 활용하여 서비스를 위해 사용하는 인프라의 비중을 조정할 수 있고, 가용성 측면에서 단일 클라우드 대비 향상된 서비스를 제공할 수 있다.
  - 하지만, 관리해야 할 영역이 늘어나고 클라우드별로 적용 가능한 보안 서비스나 정책 등이 다를 수 있다는 어려움이 있다.
- 멀티 클라우드의 보안 고려사항
  - 여러 클라우드에서 일관성 있는 사용자 인증, 보안 정책을 적용할 수 있는가?
  - 보안 이벤트 추적이 쉽고, 모니터링 가능한가?
  - 클라우드 서비스간에 접속 로그, 행위 로그 등아 연계되는가? 사용자 ID, 사용자 IP, 이벤트 발생 시간, 이벤트 상세 내용 등이 유사하게 저장되는가?
- 멀티 클라우드 구조에서 고려해야 할 보안 요소는 **복잡성 해결**이다.
  - 하나의 클라우드 내에서도 서비스별로 개발 방식이 달라 다양한 정보 교환 방법이 존재한다.
  - 이러한 서비스가 하나가 아닌 여러 클라우드 제공사에 분포되어 있을 뿐만 아니라, 클라우드별로 보안 서비스와 보안 정책도 다르다.
  - CASB는 클라우드에 상관없이 하나의 클라우드 서비스로 접점을 만들어 보안 정택을 적용해주기 때문에, 여러 클라우드의 다양성으로 인한 보안 관리의 복잡성을 줄여준다.
  - 또한, 클라우드 운영 서비스를 제공하는 **CSB**를 통해 클라우드별로 운영 노하우나 기술 부담을 줄일 수 있다.
  - 서비스 수준 계약(SLA)을 통해 기능적, 비기능적 요구사항에 대한 수준을 유지할 수 있다.

## 3. 컨테이너 기반 아키텍처와 보안 고려사항
- **컨테이너** 기반 아키텍처는 시장 상황에 따라 서비스 규모가 자주 변화하는 업무에 사용되는 아키텓처이다.
  - 컨테이너는 애플리케이션과 애플리케이션을 실행하는데 필요한 환경을 별로로 모듈화하여 격리한 공간을 뜻한다.
- 기존 가상 서버는 운영체제를 필요로 하기 때문에 전체적인 부팅과 사용하지 않는 리소스도 동작하는 시간이 필요하다.
  - 컨테이너의 경우에는 **모듈화된 프로그램 패키지**로써 프로세스 수준으로 동작하기 때문에 가볍고 빠르게 동작할 수 있다.
- 가상 서버와 컨테이너의 비교
  - |항목|**가상 서버**|**컨테이너**|
    |:-:|:-:|:-:|
    |가상화 레벨|하드웨어 가상화|OS 레벨 가상화|
    |가상화 OS|독립적인 OS 가상화 지원|여러 컨테이너가 호스트 OS 공유|
    |독립성|OS 레벨의 격리|프로세스 레벨의 격리|
    |보안 수준|높은 보안성|가상 서버 대비 낮은 보안성|
    |장점|하드웨어 가동률의 향상<br>다양한 OS 적용 가능|적은 HW 오버헤드로 높은 가용성 제공<br>플랫폼에 상관없이 실행|
    |단점|자원 소비율이 높고 가동 시간 필요|컨테이너 수가 많아지면 관리와 운영이 어려움|
- 컨테이너 기반 서비스는 큰 애플리케이션을 작은 서비스 단위로 나누어 개발함으로써 구동 환경이 달아 발생하는 특정한 서비스 이슈가 전체 서비스로 확산하는 것을 줄일 수 있다.
  - 이 같은 마이크로 서비스는 기능별로 독립된 작은 서비스들이 상호작용하여 전체 애플리케이션을 동작시키는 방식의 서비스이다.
  - 가용성 측면에서 서비스별로 구축된 컨테이너로 수요의 증가나 감소에 따라 서비스 확대/축소를 자유롭게 수행할 수 있다.
- 컨테이너 기반 클라우드 서비스 구조에서 고려할 보안 요소는 **빠른 확장성**이다.
  - 하나의 애플리케이션에서 발생한 보안 취약점이 빠른 속도로 배포되어 시스템 전체를 위협할 수 있다.
  - 클라우드의 확장성과 컨테이너의 가볍고 빠른 특성이 작용하여 악성코드가 빠르게 배포될 수 있다.
  - 이러한 보안 취약점에 대응하려면 컨테이너에 위치한 애플리케이션의 취약점을 사전에 제거하는 것과, 취약점 발생 시 빠르게 안전한 애플리케이션을 재배포할 수 있는 체계가 필요하다.
    - 이미 배포된 애플리케이션에서 취약점을 제거하기보다는 취약점이 제거된 애플리케이션을 빨리 재배포하는 형태로 대응하는 것이 좋다.
- 컨테이너의 보안 고려사항
  - 안전한 컨테이너들이 배포되도록 관리하는가?
  - 취약점이 존재하는 애플리케이션으로 만든 컨테이너가 빠르게 배포되는 것을 통제할 수 있는가?
  - 컨테이너 간의 독립성을 유지할 수 있는가?
- 컨테이너 관리에서는 컨테이너를 구성하는 애플리케이션의 버전 관리가 중요하다.
  - 취약한 버전의 애플리케이션은 서비스 실행 시 취약점을 가진 상태로 배포되기 때문이다.
  - 오픈소스처럼 공개된 소스코드를 사용할 때는 취약점이 존재하는 버전을 사용하고 있는지 점검이 필요하다.
  - 만약, 취약한 컨테이너가 빠르게 배포된 상황이라면 배포된 컨테이너를 수정하기보다는 안전한 컨테이너를 새로 만들어 재배포하는 것이 빠른 방법이다.
- 컨테이너는 가상 서버보다 독립성 수준이 낮다.
  - OS 수준에서 관리되는 것이 아니라 프로세스 수준에서 관리되기 때문에 컨테이너가 동작하는 OS에서 여러 컨테이너에 접속할 수 있다.
  - 따라서, 중요한 서비스 유형별로 컨테이너를 함께 구성하고 중요한 데이터를 처리하는 컨테이너는 별도의 OS 서버에 구성하는 전략이 필요하다.